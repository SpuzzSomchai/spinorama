<!DOCTYPE html>
<html lang="en">
  <head>
    <%include file="head.html"/>
  </head>
<body>

<%include file="nav_menu.html"/>
<%include file="nav_search.html"/>
<%include file="banner.html"/>

<%namespace name="util" module="utils" import="*"/>

<div class="section">
  <!-- Speakers -->
  <div class="searchresults">
    <div class="columns is-multiline is-1">
      % for speaker_name in meta:
      <div class="column is-one-quarter" id="${speaker_name | space2dash}">
	<div class="card">
	  <div class="card-image">
	    <figure class="image is-3x4">
	      <img src="pictures/${speaker_name | space2url}.jpg" alt="Spinorama"/>
	    </figure>
	  </div>
	  <header class="card-header">
	    <p class="card-header-title">${meta[speaker_name]["brand"]}<br/>${meta[speaker_name]["model"]}</p>
<%
  compute = None
  if "default_measurement" in meta[speaker_name]:
      default =  meta[speaker_name]["default_measurement"]
      if default in meta[speaker_name]["measurements"].keys():
         compute = meta[speaker_name]["measurements"][default]
%>
	  % if compute is not None and "pref_rating" in compute.keys():
	    <p class="card-header-title">(${compute["pref_rating"].get("pref_score", "")})
	      &nbsp;
	      ${compute["scaled_pref_rating"].get("scaled_pref_score")}/100
	    </p>
	  % endif
	  </header>
    	  <div class="card-content">
	    <div class="content is-small">
              % if compute is not None:
	      %   if "pref_rating" in compute.keys():
  	            <p>Bass extension: <b>${compute["pref_rating"].get("lfx_hz", "")}</b>Hz at -6dB</p>
                    % if "scaled_lfx_hz" in compute["scaled_pref_rating"]:
    	              <progress class="progress is-small is-info" value="${compute["scaled_pref_rating"]["scaled_lfx_hz"]}" max="100"></progress>
	            % endif
	            <p>Flatness: <b>&plusmn;${compute["estimates"]["ref_band"]}</b>dB ~ ${compute["estimates"]["ref_from"]}-${compute["estimates"]["ref_to"]}Hz</p>
	            <progress class="progress is-small is-success" value="${compute["scaled_pref_rating"]["scaled_flatness"]}" max="100"></progress>
	            <p>Smoothness (PIR): <b>${compute["pref_rating"]["sm_pred_in_room"]}</b></p>
	            <progress class="progress is-small is-warning" value="${compute["scaled_pref_rating"]["scaled_sm_pred_in_room"]}" max="100"></progress>
	      %   else:
  	      %     if "estimates" in compute:
	      %       if "ref_3dB" in compute["estimates"].keys():
	                <p>${compute["estimates"]["ref_3dB"]}Hz at -3dB<br/></p>
	      %       endif
	      %       if "ref_6dB" in compute["estimates"].keys():
	                <p>${compute["estimates"]["ref_6dB"]}Hz at -6dB<br/></p>
	      %       endif
	      %       if "ref_band" in compute["estimates"].keys():
	                <p>&plusmn;${compute["estimates"]["ref_band"]}dB ~ ${compute["estimates"]["ref_from"]}-${compute["estimates"]["ref_to"]}Hz</p>
	      %       endif
	      %     endif
	      %   endif
	      % endif
	    </div>
	  </div>
	  <footer class="card-footer">
	    % for v, m in meta[speaker_name]["measurements"].items():
	    <a class="card-footer-item"
	       href="${speaker_name|space2url}/${m["origin"]|removeVendors}/index_${v}.html">
              % if "Misc" in m["origin"] and "misc-" in v:
              <%
                v2 = '{}'.format(v[5:].capitalize())
                if '-horizontal' in v2:
                    v2 = v2[:-11]
                elif '-vertical' in v2:
                    v2 = v2[:-9]
              %>
                ${v2}
              % else:
                ${m["origin"]}
              % endif
              % if "horizontal" in v:
              (Horizontal orientation)
              % elif "vertical" in v:
              (Vertical orientation)
              % elif "-v1-" in v:
              (v1)
              % elif "-v2-" in v:
              (v2)
              % elif "-v3-" in v:
              (v3)
              % endif
            </a>
	    % endfor
	  </footer>
	</div>
      </div>
      % endfor
    </div>
  </div>
</div>


<%include file="footer.html"/>
